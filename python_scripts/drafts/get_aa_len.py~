import pandas as pd
import matplotlib.pyplot as plt
import argparse
import numpy as np




def get_files():
	parser = argparse.ArgumentParser(description='')
	#parser.add_argument('-i', '--input', help="Path to Right_and_left_distances.tsv which was created using calc_stat.py", required=True, nargs='+')
	parser.add_argument('-i', '--input', help="", required=True, nargs='+')
	
	args = parser.parse_args()
	arguments = args.__dict__
	return arguments



def main():
	infiles = get_files()
	genome_accession = []
	genome_pos = []
	query = []
	len_query = []
	list_prots = []
	new_df = pd.DataFrame()
	for file in infiles['input']:
		Distances = pd.read_csv(file, engine='python', sep='\t', error_bad_lines=False, header=0)
		queries = Distances.loc[Distances['Start_position_relative_to_query']==1]

		#kinase = queries["Length_in_aa"]/3
		#fig = plt.figure()
	
		#plt.hist(kinase, bins=50, color='#1f77b4') # 50
		#plt.title("Kinase")
		#plt.xlabel("Length [bp]")
		#plt.xlim(0,1000)
		#plt.ylabel("Frequency")
		#fig.savefig("../results/08_07_21/Histograms/Query")

		pot_fusions = queries.loc[queries.Length_in_aa > 750]
		for i in pot_fusions['Prot_accession_and_order_of_output']:
			a = i.split("#")
			list_prots.append(a[0])
	
	with open('fusions.txt', 'w') as f:
		for item in list_prots:
			f.write("%s\n" % item)
	f.close()
	
	#print(len(list_prots))		


if __name__ == "__main__":
    main()	
